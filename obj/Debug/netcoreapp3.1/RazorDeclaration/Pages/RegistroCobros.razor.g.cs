#pragma checksum "/Users/miguelgondres/Projects/Miguel-P2-AP2/Pages/RegistroCobros.razor" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "d69796de0bcc7e2b8a7dc63796faff9dfee30d50"
// <auto-generated/>
#pragma warning disable 1591
#pragma warning disable 0414
#pragma warning disable 0649
#pragma warning disable 0169

namespace Miguel_P2_AP2.Pages
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "/Users/miguelgondres/Projects/Miguel-P2-AP2/_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "/Users/miguelgondres/Projects/Miguel-P2-AP2/_Imports.razor"
using Microsoft.AspNetCore.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "/Users/miguelgondres/Projects/Miguel-P2-AP2/_Imports.razor"
using Microsoft.AspNetCore.Components.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "/Users/miguelgondres/Projects/Miguel-P2-AP2/_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "/Users/miguelgondres/Projects/Miguel-P2-AP2/_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "/Users/miguelgondres/Projects/Miguel-P2-AP2/_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "/Users/miguelgondres/Projects/Miguel-P2-AP2/_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "/Users/miguelgondres/Projects/Miguel-P2-AP2/_Imports.razor"
using Miguel_P2_AP2;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "/Users/miguelgondres/Projects/Miguel-P2-AP2/_Imports.razor"
using Miguel_P2_AP2.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "/Users/miguelgondres/Projects/Miguel-P2-AP2/_Imports.razor"
using Blazored.Toast;

#line default
#line hidden
#nullable disable
#nullable restore
#line 11 "/Users/miguelgondres/Projects/Miguel-P2-AP2/_Imports.razor"
using Blazored.Toast.Services;

#line default
#line hidden
#nullable disable
#nullable restore
#line 12 "/Users/miguelgondres/Projects/Miguel-P2-AP2/_Imports.razor"
using Blazored.Toast.Configuration;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "/Users/miguelgondres/Projects/Miguel-P2-AP2/Pages/RegistroCobros.razor"
using Miguel_P2_AP2.Models;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "/Users/miguelgondres/Projects/Miguel-P2-AP2/Pages/RegistroCobros.razor"
using Miguel_P2_AP2.BLL;

#line default
#line hidden
#nullable disable
    [Microsoft.AspNetCore.Components.RouteAttribute("/cobro")]
    public partial class RegistroCobros : Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
        }
        #pragma warning restore 1998
#nullable restore
#line 142 "/Users/miguelgondres/Projects/Miguel-P2-AP2/Pages/RegistroCobros.razor"
       

    private Cobros cobros = new Cobros();

    public int VentaId { get; set; }

    public double Monto { get; set; }
    public double Balance { get; set; }
    public double Cobrado { get; set; }
    public double TotalCobrado { get; set; }
    public int CobrosId { get; set; }
    public bool Pagar { get; set; }

    public List<Clientes> ListaClientes = new List<Clientes>();

    protected override void OnInitialized()
    {
        Nuevo();
        Buscar();
    }

    public void Nuevo()
    {
        cobros = new Cobros();
    }

    public void Guardar()
    {
        bool guardado = CobrosBLL.Guardar(cobros);
        if (guardado)
        {
            Nuevo();
            toast.ShowSuccess("Guardado");
        }
        else
        {
            toast.ShowError("No Guardado");
        }
    }

    public void Buscar()
    {
        if(cobros.CobroId > 0)
        {
            var encontrado = CobrosBLL.Buscar(cobros.CobroId);

            if (encontrado != null)
            {
                this.cobros = encontrado;
            }
            else
            {
                toast.ShowError("No encontrado");
            }

        }
    }

    public void Eliminar()
    {
        bool eliminado = CobrosBLL.Eliminar(cobros.CobroId);

        if (eliminado)
        {
            Nuevo();
            toast.ShowSuccess("Eliminado Perfectamente");
        }
        else
        {
            toast.ShowError("Hubo un error");
        }
    }

    public void agregarAlDetalle()
    {
        cobros.CobrosDetalle.Add(new CobrosDetalle
        {
            CobroDetalleId = 0,
            CobroId = cobros.CobroId,
            VentaId = VentaId,
            Fecha = DateTime.Now,
            Monto = Monto,
            Balance = Balance,
            Cobrado = Cobrado,
            Pagar = Pagar,
        });



    }

    public void ObtenerDatos()
    {
        var ventas = VentasBLL.Buscar(VentaId);
    }

    private void EliminarDetalle(CobrosDetalle detalle)
    {
        cobros.CobrosDetalle.Remove(detalle);
        CalcularMonto();
    }

    public void CalcularMonto()
    {
        cobros.Totales = 0;
        foreach(var items in cobros.CobrosDetalle)
        {
            cobros.Totales += VentasBLL.Buscar(items.VentaId).Monto;
        }
    }

    public void CalcularCobrado()
    {
        foreach(var items in cobros.CobrosDetalle)
        {
            if (items.Pagar)
            {
                TotalCobrado += items.Balance;
            }
            else
            {
                TotalCobrado += 0;
            }
        }
    }




#line default
#line hidden
#nullable disable
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IToastService toast { get; set; }
    }
}
#pragma warning restore 1591
